{% extends "base.html" %}
{% load crispy_forms_filters %}

{% block content %}
  <h1>{{ post.title }}</h1>
  <p>{{ post.owner.username }} {{ post.created_time }}</p>
  <p>{{ post.content }}</p>

  <p>{{ post.comments.count }} comment{{ post.comments.count|pluralize }}</p>
  {% if post.comments %}
    {% for comment in post.comments.all %}
      <div>
        <p>{{ comment.user.username }}  {{ comment.created_time }}</p>
        <hr>
        <p class="comment-content">{{ comment.content }}</p>
      </div>
    {% endfor %}
  {% endif %}

  <p><strong>Add a new comment</strong></p>

  {% if request.user.is_authenticated %}
    <div class="col-md-6 custom-form">
      <form action="" method="post" novalidate>
        {% csrf_token %}
        {{ form|crispy }}
        <input type="submit" value="Submit" class="btn btn-primary">
      </form>
    </div>
  {% else %}
    <div class="alert alert-light col-md-6 custom-message" role="alert">
      You need to be <a href="{% url "login" %}?next={{ request.path }}">logged in</a> to be able to post comments
    </div>
  {% endif %}

{% endblock %}
