{% extends "base.html" %}
{% load crispy_forms_filters %}

{% block content %}
  <h1>{{ post.title }}</h1>
  <p class="text-muted">by {{ post.owner }} at {{ post.created_time }}</p>
  <p class="article">{{ post.content }}</p>
  <p class="text-muted"><b>
    {{ post.commentaries.count }} comment{{ post.commentaries.count|pluralize }}
  </b></p>

  {% if post.commentaries.all %}
    <ul>
      {% for commentary in post.commentaries.all %}
        <li class="comment">
          <p>{{ commentary.user }} <small>{{ commentary.created_time }}</small></p>
          <hr>
          <p>{{ commentary.content }}</p>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>There are no comments yet.</p>
  {% endif %}

  <br>

  {% if user.is_authenticated %}
    <p><b>Add your comment here</b></p>
    <form action="" method="post" novalidate>
      {% csrf_token %}
      {{ commentary_form|crispy }}
      <input class="btn btn-primary" type="submit" value="Add comment">
    </form>
  {% else %}
    <a href="{% url 'login' %}?next={{ request.path }}">Login to leave the comment</a>
  {% endif %}
{% endblock %}
