{% extends "blog/base.html" %}
{% load crispy_forms_filters %}
{% load crispy_forms_tags %}

{% block content %}
  <div class="card mb-4 shadow-sm">
    <div class="card-body">
      <h4 class="card-title text-primary mb-3">
        {{ post.title }}
      </h4>
      <p class="card-text">
        <strong>Owner:</strong> <span class="text-muted">({{ post.owner.username }}) {{ post.owner.get_full_name }}</span><br>
        <strong>Created at:</strong> {{ post.created_time|date:"M d, Y, P" }}<br>
      </p>
      <hr>
      <p>{{ post.content }}</p>
    </div>
    <div class="card-footer text-muted">
      <strong>Comments:</strong> {{ post.commentary_set.count }}
    </div>
  </div>

  <h5 class="mb-3">üó® Comments</h5>
  {% if post.commentary_set.exists %}
    {% for comment in post.commentary_set.all %}
      <div class="border rounded p-3 mb-3 bg-light">
        <p class="mb-1">
          <strong>{{ comment.user }}:</strong> {{ comment.content }}
        </p>
      </div>
    {% endfor %}
  {% else %}
    <p class="text-muted">No comments yet.</p>
  {% endif %}

  <hr class="my-4">

  <h5>‚úç Leave a comment</h5>
  {% if user.is_authenticated %}
    <form method="post" class="mt-3">
      {% csrf_token %}
      {{ form|crispy }}
      <button type="submit" class="btn btn-primary">Add comment</button>
    </form>
  {% else %}
    <p class="text-muted">Only logged-in users can leave comments.</p>
  {% endif %}
{% endblock %}
