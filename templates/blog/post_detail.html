{% load static %}
{% load crispy_forms_tags %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{{ post.title }}</title>

  <!-- Bootstrap 4 CSS CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">

  <link rel="stylesheet" href="{% static 'css/styles.css' %}">
</head>
<body>
<div class="container my-4">
  <h1 class="page-title">{{ post.title }}</h1>

  <div class="post-item mb-4">
    <p class="post-content">{{ post.content }}</p>
    <div class="post-meta text-muted small">
      <span>Author: {{ post.owner.username }}</span> |
      <span>Created: {{ post.created_time }}</span> |
      <span>Comments: {{ post.comments.count }}</span>
    </div>
  </div>

  <h2 class="page-title" style="font-size: 1.5rem; margin-top: 40px;">Comments</h2>

  {% if post.comments.exists %}
    <ul class="list-group mb-4">
      {% for comment in post.comments.all %}
        <li class="list-group-item">
          <p class="mb-1">{{ comment.content }}</p>
          <small class="text-muted">Author: {{ comment.user.username }} | Created: {{ comment.created_time }}</small>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No comments yet.</p>
  {% endif %}

  {% if user.is_authenticated %}
    <h3>Add a comment</h3>
    <form method="post" action="{% url 'blog:comment-create' post.pk %}">
      {% csrf_token %}
      {{ form|crispy }}

      <button type="submit" class="btn btn-primary mt-3">Submit</button>
    </form>
  {% else %}
    <p><a href="{% url 'login' %}">Log in</a> to add a comment.</p>
  {% endif %}
</div>

<!-- Bootstrap 4 JS and dependencies -->
<script src="https://code.jquery.com/jquery-3.6.0.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
