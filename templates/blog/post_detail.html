{% extends "base.html" %}
{% load crispy_forms_filters %}

{% block content %}
  <title>{{ post.title }}</title>

  <h1>{{ post.title }}</h1>
    <p>{{ post.content }}</p>
    <p><strong>Author:</strong> {{ post.author.username }}, Created: {{ post.created_time }}</p>
    <p><strong>Comments: </strong>{{ post.comments.count }}</p>

  <div class="ml-3">
    <h4>Commentary</h4>

    {% for comment in post.comments.all %}
        <hr>
      <li>{{ comment.content }} ({{ comment.user }})</li>
    {% empty %}
      <p>No comments!</p>
    {% endfor %}
  </div>
  <h3>Add new comment</h3>
  <form method="post" enctype="multipart/form-data" action="{% url 'blog:comment-create' post.id %}">
        {% csrf_token %}
        {{ form|crispy }}
        <div class="form-group">
          <textarea class="form-control" id="commentContent" name="content" rows="3" required></textarea>
        </div>
    {% if user.is_authenticated %}
      <button type="submit" class="btn btn-primary">Send</button>
    {% else %}
      <button type="submit" class="btn btn-primary" disabled>Send</button>
    {% endif %}
  </form>
{% endblock %}

