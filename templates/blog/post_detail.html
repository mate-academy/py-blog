{% extends "base.html" %}

{% load crispy_forms_filters %}

{% block content %}
  <div class="container-fluid">
    <div class="h2 text-primary">
      {{ post.title }}
    </div>
    <div class="small text-secondary">
      {{ post.owner.username }} at {{ post.created_time }}
    </div>
    <p class="mt-4">
      {{ post.content }}
    </p>


    <div class="badge badge-info">
      {{ post.comments.count }} comment{{ post.comments.count|pluralize }}
    </div>
    <div class="mt-2">
        {% for commentary in post.comments.all %}
          <small>{{ commentary.user.username }} {{ commentary.created_time }}</small>
          <p class="alert alert-secondary">{{ commentary.content }}</p>
        {% empty %}
          <p class="alert alert-primary">No comments yet.</p>
        {% endfor %}
    </div>

   {% if user.is_authenticated %}
      <form method="post">
          {% csrf_token %}
          {{ form|crispy }}
          <button type="submit" class="btn btn-primary mb-5">Submit</button>
      </form>
  {% else %}
      <p>You need to <a href="{% url 'login' %}">log in</a> to leave a comment.</p>
  {% endif %}
  </div>
{% endblock %}